<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CADAgent Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Geist:wght@200;300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&family=Playfair+Display:ital,wght@0,300;0,400;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="chat.css" />
</head>
<body>
  <!-- SVG Icon Definitions -->
  <svg style="display: none;" aria-hidden="true">
    <defs>
      <!-- Loading spinner icon -->
      <symbol id="icon-loading" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" 
                stroke-linecap="round" stroke-dasharray="60" stroke-dashoffset="15" 
                opacity="0.25"/>
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" 
                stroke-linecap="round" stroke-dasharray="15 45" 
                class="spinner-path"/>
      </symbol>
      <!-- Checkmark icon -->
      <symbol id="icon-checkmark" viewBox="0 0 24 24">
        <path d="M5 13l4 4L19 7" stroke="currentColor" stroke-width="3" fill="none" 
              stroke-linecap="round" stroke-linejoin="round"/>
      </symbol>
    </defs>
  </svg>

  <div id="spaceApp" class="space-app">
    <!-- Header / Brand -->
    <header class="header-section">
      <div class="brand-container">
        <img src="../logotype.png" alt="CADAgent" class="logo" />
        <h1 class="brand-name">CAD<span class="agent">Agent</span></h1>
      </div>
      <div class="header-controls">
        <div class="version-row"><span id="version-display" class="version-badge">v0.0.0</span></div>
        <div class="status" id="connectionStatus">
          <span class="status-dot"></span>
          <span class="status-text">Connecting...</span>
        </div>
        <button id="darkModeToggle" class="dark-mode-toggle" title="Toggle theme" aria-label="Toggle dark mode">
          <span class="theme-sun">â˜€</span>
          <span class="theme-moon">ðŸŒ™</span>
        </button>
      </div>
    </header>

    <!-- API Configuration Panel -->
    <section id="apiKeySection" class="panel api-key-container">
      <div class="panel-header" onclick="toggleSection('apiKeySection')">
        <span>API Configuration</span>
        <span class="toggle-icon">â–¼</span>
      </div>
      <div class="panel-body">
        <div class="input-row">
          <div class="api-input-wrapper">
            <input type="password" id="apiKeyInput" placeholder="Enter your Anthropic API key" />
            <div id="cachedKeyOverlay" class="cached-key-overlay" style="display:none;">
              <div class="cached-key-display">
                <span class="cached-key-text">Using cached API key</span>
                <button id="resetApiKey" class="btn btn-reset" title="Clear cached key">Reset</button>
              </div>
            </div>
          </div>
          <button id="saveApiKey" class="btn save-key-btn" title="Securely cache your API key">Save API Key</button>
          <button id="testApiKey" class="btn ghost-btn">Verify</button>
        </div>
      </div>
    </section>

    <!-- Parameters Panel -->
    <section id="parametersSection" class="panel collapsed">
      <div class="panel-header" onclick="toggleSection('parametersSection')">
        <span>Model Parameters</span>
        <span class="toggle-icon">â–¼</span>
      </div>
      <div class="panel-body">
        <div id="parameterControls" class="parameter-controls"></div>
        <button id="updateParameters" class="btn accent-btn">Update Model</button>
      </div>
    </section>

    <!-- Main Chat Area -->
  <main class="chat-main main-content">
      <div id="welcomeMessage" class="welcome-hero">
        <div class="hero-inner">
          <h2 class="tagline">CAD at the speed of <em class="thought-italic">thought</em></h2>
          <p class="description">Describe what you want. Iterate instantly. Export to your design tools.</p>
        </div>
      </div>
      <div id="chatMessages" class="messages"></div>
  <div id="inputContainer" class="chat-input-dock floating-input-container">
        <div class="chat-input-dock-inner">
          <textarea id="chatInput" rows="1" placeholder="Describe a 3D model"></textarea>
          <button id="sendButton" class="send-btn" disabled>
            <span class="send-label">Send</span>
            <span class="send-icon" aria-hidden="true">âž¤</span>
          </button>
        </div>
      </div>
    </main>
  </div>

  <script>
    window.SPACE_BACKEND_CONFIG = null;
  // Central UI version identifier
  window.SPACE_APP_VERSION = 'v0.1.34';
    (function(){
      try{var el=document.getElementById('version-display'); if(el) el.textContent=window.SPACE_APP_VERSION;}catch(e){}
    })();
  </script>
  <script src="chat.js"></script>
</body>
</html>
